# 坦克大战（Tank Turbulence）

一款纯前端俯视角坦克生存小品，打开浏览器即可玩。随机地图、循环主题、弹道反弹和多种武器让每一局都不一样。

## 功能速览
- 随机关卡 + 5 种主题皮肤，墙体密度分区控制，通关自动前进下一关。
- 普通 / 一命过关两种节奏；6 款玩家涂装可选，Q 可随时回到皮肤与模式选择。
- 弹道多次反弹，带预警的敌人刷新，AI 会绕障碍靠近玩家并保持距离输出。
- 六类掉落（护盾/生命/激光/炮弹/地雷/导弹），一命模式下掉落频率与补给权重更高。
- Web Audio API 生成 BGM 和射击、爆炸、护盾等效果音，主题切换时同步乐曲。
- HUD 显示关卡、生命、敌人数量与状态提示，画面含闪光、碎片、护盾反馈。

## 运行环境
- 现代桌面浏览器：推荐最新版 Chrome/Edge/Firefox，需允许运行本地脚本与音频。
- 分辨率：默认画布 960×640，窗口化全屏或 16:9 视窗体验最佳。
- 可选本地静态服务器：如需避免浏览器的本地脚本拦截，可使用 `npx serve .`。

## 快速上手
1) 克隆或下载仓库，保持文件在同一目录。
2) 打开方式：双击 `index.html`，或在项目根目录运行 `npx serve .` 后访问终端提示的地址。
3) 阅读开场说明并点击按钮，进入模式/涂装选择界面，选定后开始战斗（Q 可随时返回此界面）。
4) 操作：`W`/`S` 前进后退，`A`/`D` 左右旋转，`Space` 射击，`R` 重开当前关；按键无响应时先点击画面获取焦点。
5) 目标：在障碍密布的场景中存活并清掉所有敌方坦克，自动进入下一关。

## 玩法机制
- 关卡节奏：每关重新生成墙体，中心/左右区域独立控制密度并预留通路；敌人数量随关卡递增，场上同时最多 3 台。
- 敌方刷新：出生点提前 1 秒显示预警圈，刷出后有短暂无敌盾，AI 会绕障碍接近玩家并保持距离输出。
- 生命与复活：默认每关开始生命补满为 `2 + 当前关数`；一命过关模式下生命跨关继承且不自动恢复，死亡后可按 R 重试当前关。
- 弹道与碰撞：普通子弹多次反弹；墙体/边界阻挡移动；激光穿透地图，炮弹/地雷范围爆炸并带碎片，导弹自动追踪后自爆。
- 模式差异：一命过关道具刷新频率 +50%，补给权重提高，敌方射击频次略降，敌人外观也会变化。
- 关卡主题：“霓虹夜幕”“紫雾黄昏”“极地霜寒”“丛林迷雾”“熔炉工厂”循环切换，影响背景、墙体和子弹/激光配色。

## 道具与武器
- 刷新规则：最长约每 7–12 秒随机掉落（“一命过关”模式下频率额外 +50%），存活 14–22 秒后消失，拾取立即生效。
- 护盾（shield）：获得 8 秒免伤护盾；玩家出生也自带短护盾。
- 生命（heart）：生命 +1，最多 `2 + 当前关数`。
- 激光（laser）：单发穿透光束，不受墙体反弹影响。
- 炮弹（cannon）：装填 2 发重炮，命中或撞墙后大范围爆炸并生成弹片。
- 地雷（mine）：获得 2 枚地雷，可投放后延迟布防，靠近触发范围爆炸。
- 导弹（missile）：装填 2 发追踪导弹，会自动锁定附近敌方单位；若在有效时间内未命中则自爆。

## 音频与表现
- Web Audio API 生成 BGM 与射击、爆炸、护盾等效果音（点击开始后解锁音频）。
- 反弹子弹、爆炸闪光和碎片使用 Canvas 渲染；玩家上方显示 HP，死亡/复活有动效提示。

## 开发提示
- 纯前端实现，无外部资源依赖；现代 Chrome/Edge/Firefox 即可运行，建议开启声音。
- 核心文件：`index.html`（入口与指引）、`style.css`（HUD/开场面板/皮肤选择）、`main.js`（地图生成、AI、物理、道具、渲染、音频）。
- 代码结构以函数划分：地图/生成逻辑、绘制、输入处理、音频合成相互独立，便于定向修改。

## 常见问题
- 浏览器拦截本地脚本：允许运行本地脚本或用本地静态服务器打开。
- 没声音：首次点击开始才会创建音频上下文；若被浏览器静音，请手动开启。
- 按键无响应：先点击画布获取焦点，或关闭浏览器的游戏模式/空格滚动等快捷键占用。
